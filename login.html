<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login | Efoyta Tech</title>
    <link rel="icon" type="image/png" href="img/favi.png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Poppins',sans-serif; }
        body { background:#eef2ff; display:flex; justify-content:center; align-items:center; min-height:100vh; padding:20px; }
        
        /* NEW: This block hides the browser's default eye icon so only YOURS shows */
        input::-ms-reveal,
        input::-ms-clear { display: none; }
        input::-webkit-contacts-auto-fill-button, 
        input::-webkit-credentials-auto-fill-button { visibility: hidden; pointer-events: none; position: absolute; right: 0; }

        .card { 
            background:#fff; width:100%; max-width:1000px; border-radius:40px; 
            box-shadow:0 15px 35px rgba(0,0,0,0.05); padding:30px 60px 60px 60px; position:relative; 
        }
        
        header { border-bottom:1px solid #ececec; margin-bottom:40px; display:flex; justify-content:space-between; align-items:center; }
        .brand-logo { font-size: 22px; font-weight: 700; color: #333; text-decoration: none; }
        .brand-logo span { color: #4378ff; }

        nav ul { display:flex; list-style:none; gap:35px; padding:10px 0; }
        nav ul li a { text-decoration:none; color:#666; font-size:14px; font-weight:500; transition:0.3s; }
        .active-link { color:#4378ff !important; border-bottom:2px solid #4378ff; padding-bottom:10px; }

        .container { display:flex; align-items:center; justify-content:space-between; gap:40px; }
        .form-section { flex:1; max-width:360px; }
        .form-section h1 { font-size:42px; font-weight:400; color:#333; margin-bottom:30px; }

        .input-group { background:#f0f0f0; border:1px solid #dcdcdc; border-radius:30px; padding:12px 20px; display:flex; align-items:center; margin-bottom:15px; }
        .input-group span { color:#333; margin-right:12px; font-size:18px; }
        .input-group input { background:transparent; border:none; outline:none; width:100%; font-size:14px; color:#666; }

        /* Password Toggle Styling */
        .toggle-password { cursor: pointer; color: #999 !important; margin-right: 0 !important; margin-left: 10px; transition: 0.3s; }
        .toggle-password:hover { color: #4378ff !important; }

        .form-options { display:flex; justify-content:space-between; align-items:center; margin-bottom:30px; font-size:12px; color:#999; }
        .forgot-pass { text-decoration:none; color:#999; font-style:italic; cursor:pointer; }
        
        .action-btn { 
            width:100%; background-color:#4378ff; color:white; border:none; padding:14px; 
            border-radius:30px; font-size:16px; font-weight:600; cursor:pointer; 
            box-shadow:0 4px 15px rgba(67,120,255,0.3); transition:0.3s; 
        }
        .action-btn:hover { background-color:#3563d9; transform:translateY(-1px); }

        .toggle-text { margin-top:20px; font-size:14px; color:#333; text-align:center; }
        .toggle-text a { color:#4378ff; text-decoration:none; font-weight:600; cursor:pointer; }

        .illustration-section { flex:1; display:flex; justify-content:center; align-items:center; position:relative; }
        .blob { position:absolute; width:450px; height:400px; background:#dbeafe; border-radius:42% 58% 70% 30% / 45% 45% 55% 55%; z-index:1; }
        .illustration-section img { position:relative; z-index:2; width:100%; max-width:350px; filter:drop-shadow(0 20px 30px rgba(0,0,0,0.1)); }

        /* MODAL STYLES */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 1000;
        }
        .modal-box {
            background: #fff; padding: 40px; border-radius: 30px; width: 90%; max-width: 450px; text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        .modal-box h2 { margin-bottom: 10px; color: #333; }
        .modal-box p { font-size: 14px; color: #777; margin-bottom: 25px; }
        .close-modal { margin-top: 15px; display: block; cursor: pointer; color: #4378ff; font-weight: 600; font-size: 14px; }

        @media(max-width:850px){
            header { flex-direction:column; gap:10px; }
            .container { flex-direction:column; text-align:center; }
            .illustration-section { display:none; }
            .form-section { max-width:100%; }
            nav ul { justify-content:center; gap: 15px; }
        }
    </style>
</head>
<body>

<div class="card">
    <header>
        <a href="index.html" class="brand-logo">Efoyta <span>Tech</span></a>
        <nav>
            <ul>
                <li><a href="index.html">HOME</a></li>
                <li><a href="about.html">ABOUT</a></li>
                <li><a href="contact.html">CONTACT</a></li>
                <li><a href="signup.html" class="active-link" id="navActionText">signup</a></li>
            </ul>
        </nav>
    </header>

    <div class="container">
        <div class="form-section">
            <h1 id="formTitle">Log in</h1>
            <form id="authForm">
                <div class="input-group">
                    <span class="ri-mail-line"></span>
                    <input type="email" id="email" placeholder="Email" required>
                </div>
                <div class="input-group">
                    <span class="ri-lock-line"></span>
                    <input type="password" id="password" placeholder="Password" required>
                    <span class="ri-eye-off-line toggle-password" id="togglePassword"></span>
                </div>

                <div class="form-options">
                    <label style="display: flex; align-items: center; gap: 5px;">
                        <input type="checkbox" id="rememberMe" checked> Remember Me
                    </label>
                    <a class="forgot-pass" id="forgotPassword">Forgot Password?</a>
                </div>

                <button type="submit" class="action-btn" id="authBtn">Log in</button>
            </form>
            <p class="toggle-text" id="toggleText">Don't have an account? <a href="signup.html" id="toggleForm">Sign up</a></p>
        </div>

        <div class="illustration-section">
            <div class="blob"></div>
            <img src="img/login image.png" alt="Login Illustration">
        </div>
    </div>
</div>

<div class="modal-overlay" id="resetModal">
    <div class="modal-box">
        <h2>Forgot Password?</h2>
        <p>Enter your email and we'll send you a recovery link if an account exists.</p>
        <div class="input-group">
            <span class="ri-mail-line"></span>
            <input type="email" id="resetEmail" placeholder="Email Address">
        </div>
        <button class="action-btn" id="confirmResetBtn">Send Reset Link</button>
        <span class="close-modal" id="closeModal">Go back to Login</span>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
    import { 
        getAuth, 
        signInWithEmailAndPassword, 
        sendPasswordResetEmail,
        signOut
    } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBHcGnd6tDNg5Wruabo8sWXO_Xz-SOrPBI",
        authDomain: "ordering-fd42a.firebaseapp.com",
        projectId: "ordering-fd42a",
        storageBucket: "ordering-fd42a.firebasestorage.app",
        messagingSenderId: "379564875478",
        appId: "1:379564875478:web:42bc00e70a594bc24ef377"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const adminEmail = "admin@gmail.com";

    const authForm = document.getElementById("authForm");
    const authBtn = document.getElementById("authBtn");
    const passwordInput = document.getElementById("password");
    const togglePasswordBtn = document.getElementById("togglePassword");
    
    // Toggle Password Visibility Logic
    togglePasswordBtn.addEventListener("click", function() {
        const type = passwordInput.getAttribute("type") === "password" ? "text" : "password";
        passwordInput.setAttribute("type", type);
        this.classList.toggle("ri-eye-line");
        this.classList.toggle("ri-eye-off-line");
    });

    const resetModal = document.getElementById("resetModal");
    const forgotPasswordBtn = document.getElementById("forgotPassword");
    const closeModal = document.getElementById("closeModal");
    const confirmResetBtn = document.getElementById("confirmResetBtn");
    const resetEmailInput = document.getElementById("resetEmail");

    forgotPasswordBtn.onclick = () => { resetModal.style.display = "flex"; };
    closeModal.onclick = () => { resetModal.style.display = "none"; };

    authForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const email = document.getElementById("email").value.trim();
        const password = passwordInput.value;

        authBtn.disabled = true;
        authBtn.textContent = "Please wait...";

        signInWithEmailAndPassword(auth, email, password)
            .then(async (userCredential) => {
                const user = userCredential.user;
                if (!user.emailVerified && user.email !== adminEmail) {
                    alert("Please verify your email first.");
                    await signOut(auth);
                    authBtn.disabled = false;
                    authBtn.textContent = "Log in";
                } else {
                    window.location.href = (user.email === adminEmail) ? "admin.html" : "profile.html";
                }
            })
            .catch(err => {
                alert("Error: " + err.message);
                authBtn.disabled = false;
                authBtn.textContent = "Log in";
            });
    });

    confirmResetBtn.onclick = async () => {
        const email = resetEmailInput.value.trim();
        if (!email) {
            alert("Please enter an email address.");
            return;
        }

        confirmResetBtn.disabled = true;
        confirmResetBtn.textContent = "Sending...";

        try {
            await sendPasswordResetEmail(auth, email);
            alert("If an account is registered with " + email + ", a reset link has been sent to your inbox.");
            resetModal.style.display = "none";
        } catch (error) {
            alert("If this email exists in our system, a reset link was sent.");
            resetModal.style.display = "none";
        } finally {
            confirmResetBtn.disabled = false;
            confirmResetBtn.textContent = "Send Reset Link";
        }
    };
</script>
</body>
</html>