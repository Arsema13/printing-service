<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Order - Efoyta Tech</title>
<link rel="icon" type="image/png" href="img/favi.png">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet"/>

<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;600;700&display=swap');

*{margin:0;padding:0;box-sizing:border-box;font-family:'Roboto Slab', serif;}
body{background:#eef7fc;color:#222;line-height:1.6;}

/* ================= UNIFIED NAVBAR STYLES ================= */
.navbar {
  position: fixed; top: 0; left: 0; width: 100%;
  display: flex; align-items: center; justify-content: space-between;
  padding: 15px 10%; background: rgba(15, 23, 42, 0.95);
  backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  z-index: 1000;
}
.logo { font-size: 1.6rem; font-weight: 800; color: #fff; text-decoration: none; font-family: 'Poppins', sans-serif; }
.logo span { color: #2d5bff; }

.nav_items { display: flex; list-style: none; gap: 30px; align-items: center; font-family: 'Poppins', sans-serif; }
.nav_items li a { text-decoration: none; color: rgba(255, 255, 255, 0.85); font-weight: 500; transition: 0.3s; font-size: 0.9rem; }
.nav_items li a:hover, .nav_items li a.active { color: #2d5bff; }

.profile-container { position: relative; margin-left: 20px; font-family: 'Poppins', sans-serif; }
.profile-trigger { 
  background: rgba(255, 255, 255, 0.1); padding: 8px 15px; border-radius: 50px;
  color: white; cursor: pointer; display: flex; align-items: center; gap: 8px;
  border: 1px solid rgba(255,255,255,0.1); transition: 0.3s; font-size: 0.9rem;
}
.profile-dropdown {
  position: absolute; top: 120%; right: 0; width: 200px;
  background: white; border-radius: 12px; padding: 10px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
  display: none; flex-direction: column; z-index: 1001;
}
.profile-dropdown.show { display: flex; }
.profile-dropdown a { text-decoration: none; color: #333; padding: 10px; font-size: 0.85rem; border-radius: 6px; display: flex; align-items: center; gap: 10px; }
.profile-dropdown a:hover { background: #f0f4ff; color: #2d5bff; }

.menu-toggle { display: none; color: white; font-size: 1.5rem; cursor: pointer; margin-left: 15px; }

/* ================= ORIGINAL ORDER PAGE STYLES ================= */
.sec{padding:120px 5% 5%;max-width:900px;margin:auto;}

.head_1{text-align:center;margin-bottom:2rem;}
.sub_heading{color:#007bff;font-size:1.6rem;font-weight:600;}
.heading{font-size:2.4rem;font-weight:700;}
.para{color:#555;margin-top:10px;}

.order_container{
   background:#fff;padding:2rem;border-radius:15px;
    box-shadow:0 10px 25px rgba(0,123,255,0.1);
      transition: all 0.3s ease;
}
.order_container:hover{transform: translateY(-5px);}

.order_form{display:flex;flex-direction:column;gap:1.4rem;}
.order_form label{font-weight:600;color:#004a80;}

.order_form input,
.order_form select,
.order_form textarea{
padding:0.9rem 1.2rem;border-radius:12px;
border:1px solid #0077cc;font-size:1rem;
transition: all 0.2s;
}
.order_form input:focus,
.order_form select:focus,
.order_form textarea:focus{border-color:#007bff;outline:none;box-shadow:0 0 8px rgba(0,123,255,0.2);}
.order_form textarea{resize:vertical;min-height:100px;}

.btn{
padding:0.75rem 1.5rem;border:none;border-radius:12px;
background:#007bff;color:#fff;font-weight:600;cursor:pointer;
transition: all 0.2s;
}
.btn:hover{box-shadow:0 8px 20px rgba(0,123,255,0.3); transform: translateY(-2px);}

.products_box{
 background:#f0f8ff; padding:1rem; border-radius:12px;
max-height:200px; overflow-y:auto;
}
.product_row{
display:flex; justify-content:space-between; align-items:center;
margin-bottom:8px; padding:6px 8px; border-radius:8px;
background:#e6f2ff; transition: all 0.2s;
}
.product_row:hover{background:#d0e7ff;}
.remove{
 background:red;color:#fff;border:none;
 border-radius:6px;padding:4px 10px;cursor:pointer;
font-weight:600;
}

.order_summary{
background:#f0f8ff;padding:1rem;border-radius:12px;
margin-top:10px; font-size:1.1rem;
}
.order_summary h4{color:#007bff;}
.order_summary span{font-weight:600;}

/* ================= UNIFIED FOOTER STYLES ================= */
.unified-footer { background: #0f172a; color: #94a3b8; padding: 4rem 10% 2rem; font-family: 'Poppins', sans-serif; margin-top: 50px; }
.footer-grid { display: flex; flex-wrap: wrap; gap: 4rem; border-bottom: 1px solid #1e293b; padding-bottom: 3rem; }
.footer-col { flex: 1; min-width: 250px; }
.footer-col h4 { color: white; margin-bottom: 1.5rem; }
.footer-col a { color: #94a3b8; text-decoration: none; display: block; margin-bottom: 10px; font-size: 0.9rem; transition: 0.3s; }
.footer-col a:hover { color: #2d5bff; }

@media(max-width:850px){
  .nav_items { display: none; position: absolute; top: 100%; left: 0; width: 100%; background: rgba(15, 23, 42, 0.98); flex-direction: column; padding: 20px; }
  .nav_items.active { display: flex; }
  .menu-toggle { display: block; }
  .order_form input, .order_form select, .order_form textarea, .btn{font-size:0.95rem;}
  .product_row{flex-direction:column;align-items:flex-start;}
}
</style>
</head>

<body>

<header>
  <nav class="navbar">
    <a href="index.html" class="logo">Efoyta <span>Tech</span></a>
    
    <div style="display: flex; align-items: center;">
      <ul class="nav_items" id="nav-list">
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="order.html" class="active">Order</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>

      <div class="profile-container">
        <div class="profile-trigger" id="profileTrigger">
          <i class="ri-user-3-line"></i> Account
        </div>
        <div class="profile-dropdown" id="profileMenu">
          <a href="user.html"><i class="ri-dashboard-line"></i> Dashboard</a>
          <a href="#" id="logoutBtn" style="color: #ef4444;"><i class="ri-logout-box-r-line"></i> Logout</a>
        </div>
      </div>

      <div class="menu-toggle" id="mobile-menu">
        <i class="ri-menu-line"></i>
      </div>
    </div>
  </nav>
</header>

<section class="sec">
<div class="head_1">
  <h3 class="sub_heading">Place Your Order</h3>
  <h1 class="heading">Customize Your Printed Products</h1>
  <p class="para">Select multiple products, upload design & receipt, and submit your order.</p>
</div>

<div class="order_container">
<form class="order_form" id="orderForm">

<label>Select Product</label>
<select id="material">
<option value="">Choose Product</option>

<optgroup label="Paper Bags – Duplex (With Logo)">
<option data-price="35">Small – 35 ETB</option>
<option data-price="45">Medium (1) – 45 ETB</option>
<option data-price="50">Medium (2) – 50 ETB</option>
<option data-price="60">Large – 60 ETB</option>
</optgroup>

<optgroup label="Paper Bags – Duplex (Without Logo)">
<option data-price="30">Small – 30 ETB</option>
<option data-price="42">Medium (1) – 42 ETB</option>
<option data-price="45">Medium (2) – 45 ETB</option>
<option data-price="55">Large – 55 ETB</option>
</optgroup>

<optgroup label="Paper Bags – Kaki Imported (With Logo)">
<option data-price="30">Small – 30 ETB</option>
<option data-price="35">Medium (1) – 35 ETB</option>
<option data-price="40">Medium (2) – 40 ETB</option>
<option data-price="53">Large – 53 ETB</option>
</optgroup>

<optgroup label="Paper Bags – Kaki Imported (Without Logo)">
<option data-price="23">Small (24×19 cm) – 23 ETB</option>
<option data-price="30">Medium (24×35 cm) – 30 ETB</option>
<option data-price="35">Medium (34×35 cm) – 35 ETB</option>
<option data-price="40">Large (40×35 cm) – 40 ETB</option>
</optgroup>

<optgroup label="Other Products">
<option data-price="40">Cap-40 ETB</option>
<option data-price="80">T-Shirt-80 ETB</option>
<option data-price="70">Hoodie-70 ETB</option>
<option data-price="90">Jacket-90 ETB</option>
<option data-price="80">Mugs & Cups-80 ETB</option>
<option data-price="90">Glass Bottles-90 ETB</option>
<option data-price="80">Tote / Fabric Bag-80 ETB</option>
<option data-price="80">Scarf-80 ETB</option>
<option data-price="70">Apron-70 ETB</option>
<option data-price="60">Poster-60 ETB</option>
<option data-price="90">Flyer-90 ETB</option>
</optgroup>
</select>

<label>Quantity</label>
<input type="number" id="quantity" min="1" value="1">

<button type="button" class="btn" onclick="addProduct()">Add Product</button>

<div class="products_box" id="productsBox"></div>

<label>Upload Logo / Design</label>
<input type="file" id="logo" required>

<label>Payment Information</label>
<div style="background:#f0f8ff;padding:1rem;border-radius:10px;font-size:1rem;color:#004a80; border: 1px solid #007bff;">
  <p>Telebirr: +251 90 799 2963</p>
  <p>CBE: Account No. 10000...</p>
</div>

<label>Upload Payment Receipt</label>
<input type="file" id="receipt" required>
<label>Delivery Option</label> <select id="delivery" required> <option value="">Choose</option> <option>Pickup</option> <option>Delivery</option> </select> 
<label>Delivery Address (if delivery)</label> <textarea id="address"></textarea>
<label>Full Name</label>
<input type="text" id="name" required>

<label>Email</label>
<input type="email" id="email" required>
<label>Phone Number</label>
<input type="text" id="phone" required>


<div class="order_summary">
<h4>Total: <span id="totalPrice">0</span> ETB</h4>
</div>

<button class="btn" type="submit" id="submitBtn">Place Order</button>

</form>
</div>
</section>

<footer class="unified-footer">
  <div class="footer-grid">
    <div class="footer-col">
      <h4 style="color: #2d5bff;">Efoyta Tech</h4>
      <p>The standard for digital printing in Ethiopia. High quality, zero hassle printing for your brand.</p>
    </div>
    <div class="footer-col">
      <h4>Navigation</h4>
      <a href="index.html">Home</a>
      <a href="about.html">About Us</a>
      <a href="contact.html">Contact Us</a>
    </div>
    <div class="footer-col">
      <h4>Contact Info</h4>
      <p>+251 90 799 2963</p>
      <p>eliyasminase123@gmail.com</p>
    </div>
  </div>
  <p style="text-align: center; margin-top: 3rem; font-size: 0.8rem;">© 2025 Efoyta Technologies Solution. All Rights Reserved.</p>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";
import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBHcGnd6tDNg5Wruabo8sWXO_Xz-SOrPBI",
  authDomain: "ordering-fd42a.firebaseapp.com",
  databaseURL: "https://ordering-fd42a-default-rtdb.firebaseio.com/",
  projectId: "ordering-fd42a",
  messagingSenderId: "379564875478",
  appId: "1:379564875478:web:42bc00e70a594bc24ef377"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const auth = getAuth(app);

// --- NAV TOGGLE LOGIC ---
const menuBtn = document.getElementById('mobile-menu');
const navList = document.getElementById('nav-list');
const profileTrigger = document.getElementById('profileTrigger');
const profileMenu = document.getElementById('profileMenu');

menuBtn.onclick = () => navList.classList.toggle('active');
profileTrigger.onclick = (e) => { e.stopPropagation(); profileMenu.classList.toggle('show'); };
document.onclick = () => profileMenu.classList.remove('show');
document.getElementById('logoutBtn').onclick = () => signOut(auth).then(() => window.location.href="login.html");

// --- ORIGINAL ORDER LOGIC ---
const material = document.getElementById("material");
const quantity = document.getElementById("quantity");
const logo = document.getElementById("logo");
const receipt = document.getElementById("receipt");
const delivery = document.getElementById("delivery");
const address = document.getElementById("address");
const name = document.getElementById("name");
const email = document.getElementById("email");
const phone = document.getElementById("phone");

const products = [];
const box = document.getElementById("productsBox");
const totalEl = document.getElementById("totalPrice");

window.addProduct = () => {
  const sel = material.options[material.selectedIndex];
  const qty = parseInt(quantity.value);
  if (!sel.dataset.price || qty < 1) { alert("Select a product and quantity."); return; }

  products.push({ name: sel.textContent, price: Number(sel.dataset.price), qty });
  renderProducts();
};

function renderProducts() {
  box.innerHTML = "";
  let total = 0;
  products.forEach((p, i) => {
    total += p.price * p.qty;
    const div = document.createElement("div");
    div.className = "product_row";
    div.innerHTML = `<span>${p.qty} × ${p.name}</span><span>${p.price * p.qty} ETB</span>`;
    const btn = document.createElement("button");
    btn.className = "remove"; btn.textContent = "X";
    btn.onclick = () => { products.splice(i, 1); renderProducts(); };
    div.appendChild(btn); box.appendChild(div);
  });
  totalEl.textContent = total;
}

async function uploadToCloudinary(file) {
  const formData = new FormData();
  formData.append("file", file);
  formData.append("upload_preset", "efoyta_upload");
  const res = await fetch("https://api.cloudinary.com/v1_1/ddbn2w991/image/upload", { method: "POST", body: formData });
  const data = await res.json();
  if (!data.secure_url) throw new Error("Upload failed");
  return data.secure_url;
}

document.getElementById("orderForm").addEventListener("submit", async e => {
  e.preventDefault();
  const submitBtn = document.getElementById("submitBtn");
  if (products.length === 0) { alert("Please add at least one product."); return; }

  try {
    submitBtn.disabled = true; submitBtn.textContent = "Processing...";
    const logoURL = await uploadToCloudinary(logo.files[0]);
    const receiptURL = await uploadToCloudinary(receipt.files[0]);

    await push(ref(db, "orders"), {
      products, totalETB: totalEl.textContent,
      delivery: delivery.value, address: address.value,
      name: name.value, email: email.value, phone: phone.value,
      logoURL, receiptURL, status: "Pending",
      time: new Date().toISOString()
    });

    alert("✅ Order submitted successfully!");
    window.location.href = "user.html";
  } catch (error) {
    alert("❌ Failed to submit order.");
    submitBtn.disabled = false; submitBtn.textContent = "Place Order";
  }
});
</script>
</body>
</html>